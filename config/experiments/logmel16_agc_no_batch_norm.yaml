# Log-mel 16 features with audio-level AGC normalization, no batch normalization
# For hardware implementation with weight constraints - no normalization in model

data:
  preprocessed_dir: "data/preprocessed_log_mel_16_norm"
  val_split: 0.20
  test_split: 0.10
  raw_dir: "data/speech_commands_v0.02"
  
  features:
    type: log-mel
    sample_rate: 16000
    n_features: 16
    frame_length_s: 0.032
    hop_length_s: 0.016
    fixed_duration_s: 1.024
    normalize: true  # Audio AGC normalization

augmentation:
  enable: true
  max_shift_ms: 100
  noise_prob: 0.15
  noise_std_factor: 0.05
  seed: 0

task:
  type: multiclass
  class_list: ["yes", "no", "up", "down", "left", "right", "on", "off", "stop", "go"]
  include_unknown: true
  include_background: false

model:
  # Core
  hidden_channels: 26
  kernel_size: 3
  dropout: 0.2

  # Depth
  num_blocks: 4

  # Convolutional block options
  causal: true
  activation: relu
  norm: none
  groups_for_groupnorm: 8
  use_weight_norm: false
  depthwise_separable: false
  pool: avg
  bias: false

train:
  batch_size: 32
  num_epochs: 100
  learning_rate: 1.0e-4
  weight_decay: 1.0e-5
  
  # Hardware constraints
  constrain_weights: true
  weight_min: -1.0
  weight_max: 1.0
  constrain_act: true
  act_min: 0.0
  act_max: 1024.0
  
  device: auto

  # Early stopping configuration
  early_stopping:
    enabled: true
    patience: 10             # Stop if no improvement for 10 epochs
    metric: "val_loss"        # Monitor validation loss
    min_delta: 0.001         # Minimum change to qualify as improvement
    restore_best: true       # Load best weights before stopping

  # DataLoader performance knobs
  num_workers: 2
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2

qat:
  weight_quantization_method: linear
  weight_linear_quantization_bits: 8
  weight_log2_quantization_num_levels: 4
  weight_min: -1.0
  weight_max: 1.0
  act_quantization_bits: 10
  act_max: 1024.0
  batch_size: 32
  num_epochs: 100
  learning_rate: 3.0e-5
  device: auto
  
  # DataLoader performance knobs
  num_workers: 2
  pin_memory: true
  persistent_workers: true
  prefetch_factor: 2

output:
  weights_dir: "checkpoints/logmel16_agc_no_batch_norm"
  plots_dir: "plots/logmel16_agc_no_batch_norm"
  tqdm: true